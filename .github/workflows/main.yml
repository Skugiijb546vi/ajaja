name: Direct_To_HuggingFace_CDN
on:
  workflow_dispatch:
    inputs:
      video_url:
        description: 'Ù„ÛŒÙ†Ú©ÛŒ Ú¤ÛŒØ¯ÛŒÛ†Ú©Û•'
        required: true
      file_name:
        description: 'Ù†Ø§ÙˆÛŒ ÙØ§ÛŒÙ„Û•Ú©Û•'
        required: true
        default: 'video.mp4'

jobs:
  upload_job:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ—ï¸ Setup Tools
        run: |
          sudo apt-get update -qq
          python -m pip install -U pip huggingface_hub

      - name: â¬‡ï¸ Download Video (Force Browser Headers)
        run: |
          # Ø¨Û•Ú©Ø§Ø±Ù‡ÛÙ†Ø§Ù†ÛŒ curl Ú†ÙˆÙ†Ú©Û• Ø³ÛØ±Ú¤Û•Ø±Û•Ú©Û• Ø¨Û•Ø±Ø§Ù…Ø¨Û•Ø± aria2 Ùˆ yt-dlp Ù‡Û•Ø³ØªÛŒØ§Ø±Û•
          # Ù„ÛØ±Û•Ø¯Ø§ Ù‡Û•Ù…ÙˆÙˆ Ø¦Û•Ùˆ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛŒØ§Ù†Û•Ù…Ø§Ù† Ø¯Ø§Ù†Ø§ÙˆÛ• Ú©Û• ÙˆÛØ¨Ú¯Û•Ú• Ø¨Û•Ú©Ø§Ø±ÛŒ Ø¯ÛÙ†ÛØª
          curl -L -k -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36" \
               -H "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8" \
               -H "Accept-Language: en-US,en;q=0.9" \
               -H "Connection: keep-alive" \
               --retry 3 \
               -o "video_temp.mp4" \
               "${{ inputs.video_url }}"

      - name: ğŸš€ Upload to Hugging Face
        env:
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
          FILE_NAME: ${{ inputs.file_name }}
        run: |
          python3 -c "
          import os
          from huggingface_hub import HfApi
          
          token = os.getenv('HF_TOKEN')
          target_name = os.getenv('FILE_NAME', 'video.mp4')
          repo_id = 'Sarkoakram/sarko761'
          
          if not os.path.exists('video_temp.mp4') or os.path.getsize('video_temp.mp4') < 1000:
              print('âŒ Error: Download failed or file is too small!')
              exit(1)

          api = HfApi()
          print(f'ğŸ“¤ Uploading {target_name}...')
          
          api.upload_file(
              path_or_fileobj='video_temp.mp4',
              path_in_repo=target_name,
              repo_id=repo_id,
              repo_type='dataset',
              token=token
          )
          print('âœ… Success!')
          "
